# B树与B+树

## B树的性质

1. 每个结点最多有m个分支（子树）；而最少分支树要看是否为根结点，如果是根节点且不是叶子结点则最少有两个分支，非根非叶结点至少有【m/2】个分支
2. 有n个分支的结点有n-1个关键字，它们按递增顺序排列
3. 结点内的关键字互不相等
4. 叶结点处于同一层；可以用空指针表示，是查找失败到达的位置
5. 分支指向的子节点中的关键字大于分支所在节点中前一个节点的关键字，小于节点中的后一个关键字

## B树的查找

从根结点开始，从左往右扫描结点中的关键字，如果找不到就沿着第一个比要查找的关键字大的关键字的前一个分支到下一层的结点中去查找

## B树的插入

判断当前结点key的个数是否小于等于m-1，如果满足，直接插入即可，如果不满足，将结点的中间的key将这个结点分为左右两个部分，中间的关键字放到父节点中

## B树的删除操作

1. 如果删除的关键字在叶节点上删除之后结点中关键字的个数仍然满足B树的性质就可以直接删除，否则借其兄弟结点的关键字，让其父结点中的关键字下去，然后让其兄弟结点中的关键字上去；如果兄弟结点没法借，就采取合并操作，也就是让父结点中的关键字下来，然后和关键字左右两边的结点合并起来，如果父节点不再满足规则，也需要再进行相应的调整。
2. 如果删除的关键字不在叶结点上，关键字右子树中的最小值或者左子树中的最大值替换要删除的关键字
3. 

# B+树

## B+树的性质

1. 在B+树中，具有n个关键字的结点含有n个分支；而在B-树中，具有n个关键字的结点含有n+1个分支。

2. 在B+树中，每个结点（除根结点以外）中的关键字个数n的取值范围为【m/2】<=n<=m,根结点的取值范围为2<=n<=m；而在B-树中，它们的取值范围分别是【m/2】-1<=n<=m-1和1<=n<=m-1.

3. **在B+树中叶子结点包含了全部关键字信息，叶子结点引出的指针指向记录。**

4. **B+树中所有非叶子结点仅仅起到了一个索引的作用，即结点中的每个索引项只含有对应子树的最大关键字和指向该子树的指针，不含有该关键字对应记录的存储地址；而在B-树中，每个关键字对应一个记录的存储地址。**

5. **在B+树上有一个指针指向关键字最小的叶子结点，所有叶子结点链接成一个线性链表，而B树中没有。也就是说B+树可以进行顺序查找。**

   # 优缺点比较

   ## B+树的优点：

   1. **b+树的非叶结点不含有指向记录的指针，这样，一个结点中可以容纳更多的索引项，一是可以降低树的高度，二是一个内部结点可以定位更多的叶子结点**
   2. **叶子结点通过指针链接，范围扫描十分简单，而对于B树来说，则需要在叶子结点和内部结点不同的往返移动。**

   # 共同优点

   **考虑磁盘IO的影响，它相对于内存来说是很慢的。数据库索引是存储在硬盘上的，当数据量大时，就不能把整个索引加载到内存上，只能逐一加载每一个磁盘页（对应索引树的节点）。所以我们要减少IO次数，对于树来说，IO次数就是树的高度，而“矮胖”就是b树的特征之一，m的大小取决与磁盘的大小。**

# 红黑树

* 应用：map、set、multiset、multimap的底层实现都是红黑树
* 定义和性质
  红黑树是一种含有红黑结点并能自平衡的二叉查找树（**从根到叶节点的最长路径不超过最短路径的2倍**）。
  （二叉查找树：若左子树不空，则左子树上所有节点的值都小于它的根节点的值；若右子树不空，则右子树所有节点的值都大于根节点的值；左、右子树也分别为二叉排序树；没有键值相等的节点，**查找所需的次数等于二叉树的高度**，可能不平衡，查找性能打折扣，变成线性的）
  （堆：是一种特殊的数据结构，通常被看作一棵树的数组对象，堆总是满足两点性质，1. 堆中某个结点的值总是不大于或不小于其父结点的值，2. 堆总是一棵完全二叉树）
  （完全二叉树：树中所含的n个节点和满二叉树中编号为1至n的节点一一对应。）
  （满二叉树：指的是深度为K且含有2^k-1个节点的二叉树）
  红黑树首先是一棵搜索二叉树，树中的每一个结点的颜色不是黑色就是红色。它的特性如下：
  1、根节点是黑色
  2、每一个结点不是黑色就是红色
  3、**不能有连续的两个红色结点**
  4、**从任意一个结点出发，到后代中空指针的路径上，均包含相同数量的黑色结**
  5、**每个叶子节点都是黑色的空节点**
  维持自平衡的操作：变色，左旋，右旋
* 左旋：以某个结点作为支点(旋转结点)，其右子结点变为旋转结点的父结点，右子结点的左子结点变为旋转结点的右子结点，左子结点保持不变。如图3。
* 右旋：以某个结点作为支点(旋转结点)，其左子结点变为旋转结点的父结点，左子结点的右子结点变为旋转结点的左子结点，右子结点保持不变。如图4。
* 变色：结点的颜色由红变黑或由黑变红
  ![4e1fff4b358ffdaf817b4102e6127af9.png](en-resource://database/1218:0)
  ![d7ba52f4fa88a7af1bbed5b310ab09df.png](en-resource://database/1220:0)

* 红黑树查找
  ![2ec34ede4ba9c62497a081c2c26d542a.png](en-resource://database/1222:0)

# 深度优先搜索与广度优先搜索

